{% extends 'base.html' %}

{% block title %}AI Assistant - Smart Health{% endblock %}

{% block extra_css %}
<style>
        .ai-page {
            background: var(--light-gray);
            min-height: calc(100vh - 80px);
            padding: 2rem 0;
        }
        
        .ai-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .ai-header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            color: var(--white);
            padding: 3rem 2rem;
            border-radius: 20px;
            margin-bottom: 2rem;
            text-align: center;
            box-shadow: 0 10px 30px rgba(30, 136, 229, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .ai-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 400px;
            height: 400px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
        }
        
        .ai-header::after {
            content: '';
            position: absolute;
            bottom: -50%;
            left: -10%;
            width: 400px;
            height: 400px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
        }
        
        .ai-header-content {
            position: relative;
            z-index: 1;
        }
        
        .ai-header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .ai-header h1 i {
            font-size: 3rem;
            vertical-align: middle;
            margin-right: 0.5rem;
        }
        
        .ai-header p {
            font-size: 1.2rem;
            opacity: 0.95;
        }
        
        .ai-main-card {
            background: var(--white);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 5px 30px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
        }
        
        .info-banner {
            background: linear-gradient(135deg, var(--light-blue) 0%, rgba(30, 136, 229, 0.1) 100%);
            border-left: 4px solid var(--primary-blue);
            padding: 1.25rem 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .info-banner i {
            font-size: 2rem;
            color: var(--primary-blue);
        }
        
        .info-banner-content h5 {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.25rem;
        }
        
        .info-banner-content p {
            color: var(--text-light);
            margin: 0;
        }
        
        .input-section {
            margin-bottom: 2rem;
        }
        
        .input-label {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.1rem;
        }
        
        .input-label i {
            color: var(--primary-blue);
        }
        
        .query-textarea {
            width: 100%;
            padding: 1.25rem;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 1.05rem;
            font-family: 'Poppins', sans-serif;
            resize: vertical;
            min-height: 120px;
            transition: all 0.3s ease;
        }
        
        .query-textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 0.2rem rgba(30, 136, 229, 0.15);
        }
        
        .button-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }
        
        .btn-ai-submit {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            color: var(--white);
            border: none;
            padding: 1rem 2.5rem;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(30, 136, 229, 0.3);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-ai-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(30, 136, 229, 0.4);
        }
        
        .btn-ai-submit:active {
            transform: translateY(-1px);
        }
        
        .btn-ai-clear {
            background: var(--white);
            color: var(--text-dark);
            border: 2px solid #e0e0e0;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-ai-clear:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
            transform: translateY(-2px);
        }
        
        .examples-section {
            margin-top: 2rem;
        }
        
        .examples-header {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        .example-btn {
            background: linear-gradient(135deg, var(--light-blue) 0%, rgba(30, 136, 229, 0.1) 100%);
            border: 2px solid var(--primary-blue);
            color: var(--primary-blue);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.95rem;
        }
        
        .example-btn:hover {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            color: var(--white);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(30, 136, 229, 0.3);
        }
        
        .loading-section {
            display: none;
            text-align: center;
            padding: 3rem;
            background: var(--white);
            border-radius: 20px;
            box-shadow: 0 5px 30px rgba(0,0,0,0.08);
        }
        
        .spinner {
            border: 4px solid var(--light-blue);
            border-top: 4px solid var(--primary-blue);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: var(--primary-blue);
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .results-section {
            display: none;
            background: var(--white);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 5px 30px rgba(0,0,0,0.08);
            animation: fadeInUp 0.5s ease;
        }
        
        .results-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light-gray);
        }
        
        .results-header h2 {
            color: var(--text-dark);
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }
        
        .results-header i {
            font-size: 2rem;
            color: var(--primary-blue);
        }
        
        .alert-success {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            color: #2e7d32;
            padding: 1.25rem 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .alert-success i {
            font-size: 1.5rem;
        }
        
        .alert-error {
            background: #ffebee;
            border-left: 4px solid #f44336;
            color: #c62828;
            padding: 1.25rem 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .alert-error i {
            font-size: 1.5rem;
        }
        
        .result-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .result-meta-item {
            background: var(--light-gray);
            padding: 1rem;
            border-radius: 12px;
        }
        
        .result-meta-label {
            font-size: 0.85rem;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }
        
        .result-meta-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .query-box {
            margin-bottom: 1.5rem;
        }
        
        .query-box-header {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .query-box-header i {
            color: var(--primary-blue);
        }
        
        .code-block {
            background: #1e293b;
            color: #10b981;
            padding: 1.5rem;
            border-radius: 12px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .results-data {
            background: var(--light-gray);
            padding: 1.5rem;
            border-radius: 12px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
{% endblock %}

{% block content %}
<div class="ai-page">
    <div class="container">
        <div class="ai-container">
            <!-- Header -->
            <div class="ai-header">
                <div class="ai-header-content">
                    <h1><i class="bi bi-robot"></i> Smart Health AI Assistant</h1>
                    <p>Query, Insert, Update, and Delete data using natural language powered by Google Gemini AI</p>
                </div>
            </div>
            
            <!-- Main Card -->
            <div class="ai-main-card">
                <!-- Info Banner -->
                <div class="info-banner">
                    <i class="bi bi-lightbulb"></i>
                    <div class="info-banner-content">
                        <h5>Full Database Control with AI</h5>
                        <p>Type your command in natural language. Our AI will convert it to SPARQL and execute it on the Smart Health knowledge base. You can query, insert new data, update existing records, or delete information - all with simple text commands!</p>
                    </div>
                </div>
                
                <!-- Input Section -->
                <div class="input-section">
                    <div class="input-label">
                        <i class="bi bi-chat-dots"></i>
                        <span>Your Command or Question</span>
                    </div>
                    <textarea id="prompt" class="query-textarea" rows="4" placeholder="Examples:&#10;• Show me all users&#10;• Add a new user named John with email john@example.com&#10;• Update user Alice email to newalice@example.com&#10;• Delete user Bob"></textarea>
                </div>
                
                <!-- Buttons -->
                <div class="button-group">
                    <button class="btn-ai-submit" onclick="sendQuery()">
                        <i class="bi bi-send"></i> Send Query
                    </button>
                    <button class="btn-ai-clear" onclick="clearResults()">
                        <i class="bi bi-x-circle"></i> Clear
                    </button>
                </div>
                
                <!-- Examples Section -->
                <div class="examples-section">
                    <div class="examples-header">
                        <i class="bi bi-stars"></i> Try these examples:
                    </div>
                    
                    <!-- Query Examples -->
                    <h6 style="color: var(--primary-blue); font-weight: 600; margin-top: 1rem; margin-bottom: 0.75rem;">
                        <i class="bi bi-search"></i> Query Data (SELECT)
                    </h6>
                    <div class="examples-grid">
                        <button class="example-btn" onclick="setPrompt('Show me all users')">
                            <i class="bi bi-people"></i> All Users
                        </button>
                        <button class="example-btn" onclick="setPrompt('List all activities')">
                            <i class="bi bi-activity"></i> All Activities
                        </button>
                        <button class="example-btn" onclick="setPrompt('Show health metrics')">
                            <i class="bi bi-heart-pulse"></i> Health Metrics
                        </button>
                        <button class="example-btn" onclick="setPrompt('What are the meals?')">
                            <i class="bi bi-egg-fried"></i> Meals
                        </button>
                    </div>
                    
                    <!-- Insert Examples -->
                    <h6 style="color: #4caf50; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.75rem;">
                        <i class="bi bi-plus-circle"></i> Add Data (INSERT)
                    </h6>
                    <div class="examples-grid">
                        <button class="example-btn" onclick="setPrompt('Add a new user named Alice with email alice@example.com')">
                            <i class="bi bi-person-plus"></i> Add User
                        </button>
                        <button class="example-btn" onclick="setPrompt('Create a cardio activity called Running')">
                            <i class="bi bi-plus-circle"></i> Add Activity
                        </button>
                        <button class="example-btn" onclick="setPrompt('Add a breakfast meal with 500 calories')">
                            <i class="bi bi-plus-square"></i> Add Meal
                        </button>
                        <button class="example-btn" onclick="setPrompt('Create a new challenge called 30-Day Fitness')">
                            <i class="bi bi-trophy"></i> Add Challenge
                        </button>
                    </div>
                    
                    <!-- Update Examples -->
                    <h6 style="color: #ff9800; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.75rem;">
                        <i class="bi bi-pencil-square"></i> Update Data (UPDATE)
                    </h6>
                    <div class="examples-grid">
                        <button class="example-btn" onclick="setPrompt('Update user Alice email to newalice@example.com')">
                            <i class="bi bi-pencil"></i> Update Email
                        </button>
                        <button class="example-btn" onclick="setPrompt('Change Running activity duration to 45 minutes')">
                            <i class="bi bi-arrow-clockwise"></i> Update Activity
                        </button>
                        <button class="example-btn" onclick="setPrompt('Set breakfast meal calories to 600')">
                            <i class="bi bi-pencil-square"></i> Update Meal
                        </button>
                    </div>
                    
                    <!-- Delete Examples -->
                    <h6 style="color: #f44336; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.75rem;">
                        <i class="bi bi-trash"></i> Delete Data (DELETE)
                    </h6>
                    <div class="examples-grid">
                        <button class="example-btn" onclick="setPrompt('Delete user Alice')">
                            <i class="bi bi-person-x"></i> Delete User
                        </button>
                        <button class="example-btn" onclick="setPrompt('Remove activity Running')">
                            <i class="bi bi-x-circle"></i> Delete Activity
                        </button>
                        <button class="example-btn" onclick="setPrompt('Delete the breakfast meal')">
                            <i class="bi bi-trash"></i> Delete Meal
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Loading Section -->
            <div class="loading-section" id="loading">
                <div class="spinner"></div>
                <p class="loading-text"><i class="bi bi-gear-fill"></i> Processing your query...</p>
            </div>
            
            <!-- Results Section -->
            <div class="results-section" id="results">
                <div class="results-header">
                    <i class="bi bi-bar-chart"></i>
                    <h2>Results</h2>
                </div>
                <div id="results-content"></div>
            </div>
        </div>
    </div>
</div>
    
{% endblock %}

{% block extra_js %}
<script>
    const API_URL = 'http://127.0.0.1:8000/api/ai/query/';
    
    function setPrompt(text) {
        document.getElementById('prompt').value = text;
        document.getElementById('prompt').focus();
    }
    
    function clearResults() {
        document.getElementById('prompt').value = '';
        document.getElementById('results').style.display = 'none';
        document.getElementById('results-content').innerHTML = '';
    }
    
    async function sendQuery() {
        const prompt = document.getElementById('prompt').value.trim();
        
        if (!prompt) {
            alert('⚠️ Please enter a question!');
            return;
        }
        
        // Show loading
        document.getElementById('loading').style.display = 'block';
        document.getElementById('results').style.display = 'none';
        
        // Scroll to loading
        document.getElementById('loading').scrollIntoView({ behavior: 'smooth', block: 'center' });
        
        try {
            // Get current user ID from Django template
            const userId = '{{ request.user.user_id }}';
            
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ 
                    prompt: prompt,
                    user_id: userId ? parseInt(userId) : null
                })
            });
            
            const data = await response.json();
            
            // Hide loading
            document.getElementById('loading').style.display = 'none';
            
            // Show results
            document.getElementById('results').style.display = 'block';
            
            let html = '';
            
            if (data.success) {
                // Determine action type for styling
                const actionType = data.action || 'query';
                const actionColor = {
                    'query': '#1e88e5',
                    'insert': '#4caf50',
                    'update': '#ff9800',
                    'delete': '#f44336'
                }[actionType] || '#1e88e5';
                
                const actionIcon = {
                    'query': 'search',
                    'insert': 'plus-circle',
                    'update': 'pencil-square',
                    'delete': 'trash'
                }[actionType] || 'check-circle';
                
                // Success Alert with action-specific styling
                html += `
                    <div class="alert-success" style="border-left-color: ${actionColor}">
                        <i class="bi bi-${actionIcon}-fill" style="color: ${actionColor}"></i>
                        <span><strong>Success!</strong> ${data.message || `${actionType.toUpperCase()} operation completed successfully`}</span>
                    </div>
                `;
                
                // Meta Information
                html += '<div class="result-meta">';
                html += `
                    <div class="result-meta-item">
                        <div class="result-meta-label">Action</div>
                        <div class="result-meta-value" style="color: ${actionColor}">
                            <i class="bi bi-${actionIcon}"></i> ${actionType.toUpperCase()}
                        </div>
                    </div>
                `;
                html += `
                    <div class="result-meta-item">
                        <div class="result-meta-label">Intent</div>
                        <div class="result-meta-value"><i class="bi bi-bullseye"></i> ${data.intent || 'N/A'}</div>
                    </div>
                `;
                
                // Show results count only for query actions
                if (actionType === 'query') {
                    html += `
                        <div class="result-meta-item">
                            <div class="result-meta-label">Results Count</div>
                            <div class="result-meta-value"><i class="bi bi-hash"></i> ${data.results_count || 0}</div>
                        </div>
                    `;
                }
                
                if (data.user_id) {
                    html += `
                        <div class="result-meta-item">
                            <div class="result-meta-label">User ID</div>
                            <div class="result-meta-value"><i class="bi bi-person"></i> ${data.user_id}</div>
                        </div>
                    `;
                }
                html += `
                    <div class="result-meta-item">
                        <div class="result-meta-label">AI Model</div>
                        <div class="result-meta-value"><i class="bi bi-robot"></i> ${data.ai_model || 'Gemini'}</div>
                    </div>
                `;
                html += '</div>';
                
                // SPARQL Query
                html += `
                    <div class="query-box">
                        <div class="query-box-header">
                            <i class="bi bi-code-slash"></i>
                            <span>Generated SPARQL ${actionType.toUpperCase()}</span>
                        </div>
                        <pre class="code-block">${escapeHtml(data.sparql_query || 'N/A')}</pre>
                    </div>
                `;
                
                // Results Data (only for query actions)
                if (actionType === 'query' && data.results) {
                    html += `
                        <div class="query-box">
                            <div class="query-box-header">
                                <i class="bi bi-table"></i>
                                <span>Query Results (${data.results_count || 0} items)</span>
                            </div>
                            <pre class="code-block results-data">${JSON.stringify(data.results, null, 2)}</pre>
                        </div>
                    `;
                }
            } else {
                // Error Alert
                html += `
                    <div class="alert-error">
                        <i class="bi bi-exclamation-triangle-fill"></i>
                        <div>
                            <strong>Error:</strong> ${data.error || 'Unknown error'}
                            ${data.message ? '<br><small>' + data.message + '</small>' : ''}
                        </div>
                    </div>
                `;
                
                // Show setup instructions if AI service is not configured
                if (data.error && data.error.includes('not configured') && data.setup_instructions) {
                    html += `
                        <div class="query-box" style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem;">
                            <div class="query-box-header" style="color: #856404;">
                                <i class="bi bi-gear-fill"></i>
                                <span>Setup Instructions</span>
                            </div>
                            <ol style="margin: 1rem 0; padding-left: 1.5rem; color: #856404;">
                                ${data.setup_instructions.map(instruction => `<li style="margin-bottom: 0.5rem;">${escapeHtml(instruction)}</li>`).join('')}
                            </ol>
                            <div style="margin-top: 1rem; padding: 1rem; background: white; border-radius: 8px; border: 1px solid #ffc107;">
                                <strong style="color: #856404;">Quick Setup:</strong>
                                <ol style="margin: 0.5rem 0; padding-left: 1.5rem; color: #856404;">
                                    <li>Get your free API key: <a href="https://makersuite.google.com/app/apikey" target="_blank" style="color: #1e88e5;">https://makersuite.google.com/app/apikey</a></li>
                                    <li>Create a <code style="background: #f0f0f0; padding: 0.2rem 0.4rem; border-radius: 4px;">.env</code> file in the project root</li>
                                    <li>Add this line: <code style="background: #f0f0f0; padding: 0.2rem 0.4rem; border-radius: 4px;">GEMINI_API_KEY=your_key_here</code></li>
                                    <li>Restart the Django server</li>
                                </ol>
                            </div>
                        </div>
                    `;
                }
                
                // Error Details
                if (data.details) {
                    html += `
                        <div class="query-box">
                            <div class="query-box-header">
                                <i class="bi bi-info-circle"></i>
                                <span>Error Details</span>
                            </div>
                            <pre class="code-block">${escapeHtml(data.details)}</pre>
                        </div>
                    `;
                }
            }
            
            document.getElementById('results-content').innerHTML = html;
            
            // Scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
            
        } catch (error) {
            // Hide loading
            document.getElementById('loading').style.display = 'none';
            
            // Show error
            document.getElementById('results').style.display = 'block';
            document.getElementById('results-content').innerHTML = `
                <div class="alert-error">
                    <i class="bi bi-exclamation-triangle-fill"></i>
                    <div>
                        <strong>Connection Error</strong><br>
                        <small>${error.message}</small><br>
                        <small>Make sure the Django server is running at ${API_URL}</small>
                    </div>
                </div>
            `;
            
            // Scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }
    
    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
    
    // Allow Enter key to submit (Shift+Enter for new line)
    document.getElementById('prompt').addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendQuery();
        }
    });
    
    // Auto-focus on prompt
    document.getElementById('prompt').focus();
    
    // Check AI service status on page load
    async function checkAIStatus() {
        try {
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ prompt: 'test' })
            });
            
            const data = await response.json();
            
            // If AI service is not configured, show a warning banner
            if (!data.success && data.error && data.error.includes('not configured')) {
                const infoBanner = document.querySelector('.info-banner');
                if (infoBanner) {
                    infoBanner.style.background = 'linear-gradient(135deg, #fff3cd 0%, rgba(255, 193, 7, 0.1) 100%)';
                    infoBanner.style.borderLeftColor = '#ffc107';
                    infoBanner.innerHTML = `
                        <i class="bi bi-exclamation-triangle-fill" style="color: #856404; font-size: 2rem;"></i>
                        <div class="info-banner-content">
                            <h5 style="color: #856404;">⚠️ AI Service Not Configured</h5>
                            <p style="color: #856404;">
                                The AI service requires a Gemini API key. 
                                <a href="https://makersuite.google.com/app/apikey" target="_blank" style="color: #1e88e5; font-weight: 600;">Get your free API key here</a>, 
                                then add <code style="background: rgba(0,0,0,0.1); padding: 0.2rem 0.4rem; border-radius: 4px;">GEMINI_API_KEY=your_key</code> to a <code style="background: rgba(0,0,0,0.1); padding: 0.2rem 0.4rem; border-radius: 4px;">.env</code> file in the project root and restart the server.
                            </p>
                        </div>
                    `;
                }
            }
        } catch (error) {
            // Silently fail - server might not be running
            console.log('Could not check AI status:', error.message);
        }
    }
    
    // Check status when page loads
    checkAIStatus();
</script>
{% endblock %}
