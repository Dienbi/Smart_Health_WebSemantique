{% extends 'admin_base.html' %}

{% block title %}{{ defi.defi_name }} - Détail{% endblock %}

{% block content %}
<div class="container">
    <h3>{{ defi.defi_name }}</h3>
    <p>{{ defi.defi_description }}</p>
    <p class="text-muted">Créé le {{ defi.created_at|date:'SHORT_DATETIME_FORMAT' }}</p>
    <div class="mt-3">
        <a href="{% url 'defis_admin:list' %}" class="btn btn-outline-secondary">Retour</a>
        <a href="{% url 'defis_admin:edit' defi.pk %}" class="btn btn-secondary ms-2">Modifier</a>
        <a href="{% url 'defis_admin:delete' defi.pk %}" class="btn btn-danger ms-2">Supprimer</a>
    </div>
    <div class="mt-4">
        <h5>Détails liés</h5>
        <p><strong>Participants:</strong> {{ participants_count }}</p>

        {% if defi_status %}
            <p><strong>Statut:</strong>
            {% if defi_status.completed %}
                <span class="badge bg-success">Terminé</span>
            {% elif defi_status.in_progress %}
                <span class="badge bg-warning text-dark">En cours</span>
            {% else %}
                <span class="badge bg-secondary">Non démarré</span>
            {% endif %}
            </p>
        {% endif %}

        {% if defi_badge %}
            <p><strong>Badges:</strong>
                {% if defi_badge.gold %}<span class="badge bg-primary">Or</span>{% endif %}
                {% if defi_badge.silver %}<span class="badge bg-secondary">Argent</span>{% endif %}
                {% if defi_badge.bronze %}<span class="badge bg-warning text-dark">Bronze</span>{% endif %}
                {% if not defi_badge.gold and not defi_badge.silver and not defi_badge.bronze %}<span class="text-muted">Aucun</span>{% endif %}
            </p>
        {% endif %}

        <div class="mt-3">
            <h6>Objectifs</h6>
            {% if objectives %}
                <ul class="list-group">
                    {% for obj in objectives %}
                        <li class="list-group-item">
                            <div class="d-flex justify-content-between">
                                <div>{{ obj.description }}</div>
                                <small class="text-muted">{{ obj.start_date|date:'SHORT_DATE_FORMAT' }} — {{ obj.end_date|date:'SHORT_DATE_FORMAT' }}</small>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p class="text-muted">Aucun objectif défini.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
